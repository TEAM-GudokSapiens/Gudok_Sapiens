{% extends 'base.html' %}

{% block content %}
    {{ board.update_counter }}
    <h3>{{ board.title }}</h3>
    작성일: {{ board.created_at  | date:"Y/m/d" }} <br>
    좋아요
    조회수 : {{ board.hits }} <br>
    <hr>
    {{ board.content }} <br>
    
    {% if board.img %}
    <img src="{{ board.img.url }}" style="width: 450px;"> <br>
    {% else %}
    <p></p>
    {% endif %}

    <hr>
    <a href="{%url 'community:board'%}">목록으로 </a> <br>

    <!--로그인한 사람 == 작성자 일때만 삭제가능-->
    {% if user.username == board.user.username %}
    <a href="{% url 'community:board_delete' board.id %}">삭제하기</a>
    {% endif %}
    
    <textarea class="commentContent" placeholder="
    저작권 등 다른 사람의 권리를 침해하거나 명예를 훼손하는 게시물은 이용약관 및 관련 법률에 의해 제재를 받을 수 있습니다. 건전한 토론문화와 양질의 댓글 문화를 위해, 타인에게 불쾌감을 주는 욕설 또는 특정 계층/민족, 종교 등을 비하하는 단어들은 표시가 제한됩니다."></textarea>
    <input type="button" class="btnReply" value="등록">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
        let btnReply = document.querySelector('.btnReply')
        btnReply.addEventListener('click', e => {
            
            let content = document.querySelector('.commentContent').value;
            let param = {
                'user': '{{ target.user.id }}',
                'target': '{{ target.id }}',
                'content': content,
            }

            $.ajax({
                url: "{% url 'community:reply' %}",
                type: 'POST',
                headers: {
                    'X-CSRFTOKEN' : '{{ csrf_token}}'
                },
                data : JSON.stringify(param),
                success:function(data){
                    console.log(data)
                },
                error: function(){
                    alert('변경불가');
                }
                })
        })
    </script>
    {% endblock %}